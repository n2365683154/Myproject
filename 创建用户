docker exec -it exam_backend python -c "
from app.database import SessionLocal
from app.models.user import User, Role, UserRole
import datetime

db = SessionLocal()

# 检查管理员角色
admin_role = db.query(Role).filter(Role.code == 'admin').first()
if not admin_role:
    admin_role = Role(
        name='管理员',
        code='admin',
        description='系统管理员',
        is_active=True
    )
    db.add(admin_role)
    db.commit()
    db.refresh(admin_role)
    print('管理员角色创建成功')
else:
    print('管理员角色已存在')

# 检查管理员用户
admin = db.query(User).filter(User.username == 'admin').first()
if not admin:
    # 创建管理员（使用hashed_password字段）
    admin = User(
        username='admin',
        hashed_password='admin123',  # 使用正确的字段名
        email=None,
        phone=None,
        real_name='系统管理员',
        is_active=True,
        is_superuser=True,
        created_at=datetime.datetime.now()
    )
    db.add(admin)
    db.commit()
    db.refresh(admin)
    
    # 添加用户-角色关联
    user_role = UserRole(
        user_id=admin.id,
        role_id=admin_role.id
    )
    db.add(user_role)
    db.commit()
    print('管理员账号创建成功')
else:
    print('管理员账号已存在')

db.close()
"